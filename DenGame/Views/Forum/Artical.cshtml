@model DenGame.Models.ArticleList;

@{
	ViewData["Title"] = "Artical";
}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<script src="https://kit.fontawesome.com/b5dde33e16.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="~/css/artical.css" asp-append-version="true" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
	  integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<style>
	img {
		max-width: 100%;
		max-height: 500px;
		object-fit: cover;
	}

	a {
		text-decoration: none;
	}

	. {
		box-sizing: border-box;
	}
</style>

<body>
	<div class="d-flex  m-auto">
		<div class="shadow border border-1 rounded w-100 m-auto mt-4 me-3">
			<div class="m-4 ">
				<h3>@Model.ArticalTitle</h3>
				<hr>
				<!-- user -->
				<div class="d-flex mb-3">
					<div>
						<img class="rounded-circle" style="width: 50px;"
							 src="https://upload-os-bbs.hoyolab.com/upload/2024/04/24/d6048f30e1ec7c52013ad5ed41500099_293482052564117040.png?x-oss-process=image%2Fresize%2Cs_600%2Fauto-orient%2C0%2Finterlace%2C1%2Fformat%2Cwebp%2Fquality%2Cq_80">
						</img>
					</div>
					<div class="ms-1">
						<span class="text-primary ">坂坂悠</span>
						<p class="text-secondary " style="font-size: x-small;">@Model.ArticalCreateDate</p>
					</div>
				</div>

				<div>
					@Html.Raw(Model.ArticalContent)
				</div>
				<!-- 按讚 -->
				<div class="mb-2">
					<button class="btn "><i class="bi bi-chat-dots h4"></i></button><span>2</span>
					<button id="btnArticalLike" class="btn "><i class="bi bi-hand-thumbs-up h4 "></i></button><span id="likeNumber">0</span>
				</div>
				<!-- 留言 -->

				<div class="mb-4">
					<form asp-action="AddComment" asp-controller="Forum" method="post">
						<div class="input-group mb-4">
							<i class="bi bi-chat-left-text input-group-text"></i>
							<input type="hidden" name="articalId" value="@Model.ArticalId" />
							<input id="input-box" type="text" name="comment" class="form-control" placeholder="快來發表你的評論吧">
							<div class="input-group-append">
								<button id="emoji-button" class="btn btn-outline-secondary " type="button"><i class="bi bi-emoji-smile  "></i></button>
								<button type="submit" class="btn btn-outline-secondary ">發送</button>
							</div>
						</div>
						<div id="emoji-picker">
							<span class="emoji">😊</span>
							<span class="emoji">😂</span>
							<span class="emoji">😍</span>
							<span class="emoji">😢</span>
							<span class="emoji">😎</span>
							<span class="emoji">🤔</span>
						</div>

					</form>
				</div>

				<!-- 評論區 -->
				<div class="d-flex mb-2">
					<div>
						<img class="rounded-circle" style="width: 40px;"
							 src="https://upload-os-bbs.hoyolab.com/upload/2024/04/24/df5099918ba860b71130060d123a71dd_5262774949539197790.png?x-oss-process=image%2Fresize%2Cs_600%2Fauto-orient%2C0%2Finterlace%2C1%2Fformat%2Cwebp%2Fquality%2Cq_80">
						</img>
					</div>
					<!--  -->
					<div class="userComment ms-2">
						<span class="text-primary">坂坂悠</span>
						<span>【原神】參與「碎片拾憶」活動！這是我的召回碼，快來綁定吧~ GDSYBAL52K</span>
						<div class="text-secondary" style="font-size: x-small;">
							<span class="ms-1">5小時前</span>
							<span class="ms-3"><button class="reply">回覆</button></span>
							<div class="btn-group btn-group-sm">
								<button class="btn "><i class="bi bi-hand-thumbs-up"></i></button>

							</div>
						</div>
						<form asp-action="AddReply" asp-controller="Forum" method="post" class="comment-form">
							<div class="input-group mb-4 replyInput" style="display:none;">
								<input type="text" class="form-control" placeholder="快來發表你的評論吧">
								<div class="input-group-append">
									<button  class="btn btn-outline-secondary emoji-button" type="button"><i class="bi bi-emoji-smile  "></i></button></i >
									<button type="submit" class="btn btn-outline-secondary">發送</button>
								</div>
							</div>
							<div class="emoji-picker" style="display:none;">
								<span class="emoji">😊</span>
								<span class="emoji">😂</span>
								<span class="emoji">😍</span>
								<span class="emoji">😢</span>
								<span class="emoji">😎</span>
								<span class="emoji">🤔</span>
							</div>
						</form>
					</div>

				</div>
				<!-- 評論區 -->


			</div>

		</div>
		<!-- 右側 -->
		<div class="m-1 p-1">
			<div class="p-3 rounded">
				<div class="input-group">
					<input type="search" class="w-75 form-control" placeholder="搜尋文章">
					<button class="btn btn-outline-secondary"><i class="fa-solid fa-magnifying-glass"></i></button>
				</div>

			</div>
			<div class="mt-1  p-3 rounded ">
				<div class="list-group">
					<a href="/Forum/Post" class="btn btn-outline-secondary">快來發文吧!</a>
				</div>

			</div>
			<div class="mt-1  p-3 rounded ">
				<div class="list-group">
					<a href="/Forum/ForumUser" class="btn btn-outline-secondary">個人主頁</a>
				</div>

			</div>

		</div>
	</div>
</body>
<script src="~/js/artical.js"></script>
<script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js" ></script>
<script>
	$(document).ready(function () {
		$("oembed").each(function () {
			var url = $(this).attr("url");
			if (url.includes("youtube.com")) {
				var videoId = url.split("v=")[1];
				var embedUrl = "https://www.youtube.com/embed/" + videoId;
				$(this).replaceWith('<iframe width="560" height="315" src="' + embedUrl + '" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');
			}
		});

		$(".reply").click(function () {
			$(".replyInput").toggle();
		});

		var num = 0;
		$('#btnArticalLike').on('click', function () {

			num++;

			$('#likeNumber').html(num);

		})
	});

</script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		const emojiButton = document.getElementById('emoji-button');
		const emojiPicker = document.getElementById('emoji-picker');
		const inputBox = document.getElementById('input-box');

		emojiButton.addEventListener('click', () => {
			emojiPicker.style.display = emojiPicker.style.display === 'block' ? 'none' : 'block';
		});

		emojiPicker.addEventListener('click', (event) => {
			if (event.target.classList.contains('emoji')) {
				inputBox.value += event.target.textContent;
				emojiPicker.style.display = 'none';
			}
		});

		document.addEventListener('click', (event) => {
			if (!emojiPicker.contains(event.target) && !emojiButton.contains(event.target)) {
				emojiPicker.style.display = 'none';
			}
		});
	});
	document.addEventListener('DOMContentLoaded', () => {
		document.querySelectorAll('.comment-form').forEach(form => {
			const emojiButton = form.querySelector('.emoji-button');
			const emojiPicker = form.querySelector('.emoji-picker');
			const inputBox = form.querySelector('.input-box');

			emojiButton.addEventListener('click', () => {
				emojiPicker.style.display = emojiPicker.style.display === 'block' ? 'none' : 'block';
			});

			emojiPicker.addEventListener('click', (event) => {
				if (event.target.classList.contains('emoji')) {
					inputBox.value += event.target.textContent;
					emojiPicker.style.display = 'none';
				}
			});

			document.addEventListener('click', (event) => {
				if (!emojiPicker.contains(event.target) && !emojiButton.contains(event.target)) {
					emojiPicker.style.display = 'none';
				}
			});
		});
	});
</script>